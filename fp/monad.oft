(module std/fp/monad
  <$>
  <*>
  >>=
  do
  pure)

(defmethod <$>)
(defmethod <*>)
(defmethod >>=)
(defmethod pure)

;; Monadic do notation.
;;
;; TODO: Implement ApplicativeDo
(defmacro do (hd ... tl)
  (cond
    (nil? tl)       hd
    (shl? 'mdef hd) `(>>= ,(caddr hd) (fn (,(cadr hd)) (do ,@tl)))
    else            `(progn ,hd (do ,@tl))))
