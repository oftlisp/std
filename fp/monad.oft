(module std/fp/monad
  <$>
  <*>
  >>=
  do)

(defmethod <$>)
(defmethod <*>)
(defmethod >>=)

;; Monadic do notation.
;;
;; TODO: Implement ApplicativeDo
(defmacro do (hd ... tl)
  (cond
    (nil? tl)       hd
    (shl? hd 'mdef) `(>>= ,(caddr hd) (fn (,(cadr hd)) (do ,@tl)))
    else            `(progn ,hd (do ,@tl))))
